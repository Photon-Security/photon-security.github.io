<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="IE=edge"><!-- SEO --><title>LLMs, HTTPS Requests and Response Tampering</title><meta name="description" content="How corporate network proxies and DPI devices tamper with HTTPS requests and responses — and why this breaks LLM CLI tools, AI coding assistants, and API clients in enterprise environments."><link rel="canonical" href="https://photonsec.com.au/articles/llms-https-requests-response-tampering/"><!-- Open Graph --><meta property="og:type" content="website"><meta property="og:url" content="https://photonsec.com.au/articles/llms-https-requests-response-tampering/"><meta property="og:title" content="LLMs, HTTPS Requests and Response Tampering"><meta property="og:description" content="How corporate network proxies and DPI devices tamper with HTTPS requests and responses — and why this breaks LLM CLI tools, AI coding assistants, and API clients in enterprise environments."><meta property="og:image" content="https://photonsec.com.au/photon-sec-banner.jpeg"><meta property="og:site_name" content="PhotonSec"><meta property="og:locale" content="en_AU"><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="LLMs, HTTPS Requests and Response Tampering"><meta name="twitter:description" content="How corporate network proxies and DPI devices tamper with HTTPS requests and responses — and why this breaks LLM CLI tools, AI coding assistants, and API clients in enterprise environments."><meta name="twitter:image" content="https://photonsec.com.au/photon-sec-banner.jpeg"><!-- Favicon --><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="icon" type="image/png" href="/favicon.png"><link rel="apple-touch-icon" href="/favicon.png"><!-- Fonts (self-hosted alternative: use Google Fonts preconnect) --><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap"><!-- JSON-LD Structured Data --><script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Florian Bidabé",
        "jobTitle": "Cyber Security Leader",
        "url": "https://photonsec.com.au",
        "sameAs": [
          "https://github.com/Enelass",
          "https://www.linkedin.com/in/bidabe"
        ],
        "worksFor": {
          "@type": "Organization",
          "name": "Commonwealth Bank of Australia"
        }
      }
    </script><link rel="stylesheet" href="/assets/_slug_.CriIN7Iy.css"></head> <body class="bg-bg-primary"> <header id="nav-header" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300"> <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"> <div class="flex items-center justify-between h-16"> <!-- Logo --> <a href="/" class="flex items-center gap-3 group"> <img src="/photon-sec-logo-banner.svg" alt="PhotonSec" class="h-12 w-auto opacity-90 group-hover:opacity-100 transition-opacity"> </a> <!-- Desktop Nav --> <div class="hidden md:flex items-center gap-1"> <a href="/" class="px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 text-text-secondary hover:text-white hover:bg-bg-raised"> Home </a><a href="/about" class="px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 text-text-secondary hover:text-white hover:bg-bg-raised"> About </a><a href="/projects" class="px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 text-text-secondary hover:text-white hover:bg-bg-raised"> Projects </a><a href="/articles" class="px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 text-accent-blue bg-accent-blue/10"> Articles </a><a href="/findings" class="px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 text-text-secondary hover:text-white hover:bg-bg-raised"> Findings </a> <a href="/members/dashboard" class="ml-3 px-4 py-2 bg-accent-blue/20 border border-accent-blue/40 text-accent-blue text-sm font-semibold rounded-lg hover:bg-accent-blue hover:text-white transition-all duration-200">
Member Zone
</a> </div> <!-- Mobile menu button --> <button id="mobile-menu-btn" class="md:hidden p-2 text-text-secondary hover:text-white transition-colors" aria-label="Toggle menu" aria-expanded="false"> <svg id="menu-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path> </svg> <svg id="close-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path> </svg> </button> </div> <!-- Mobile Nav --> <div id="mobile-menu" class="hidden md:hidden pb-4 border-t border-border-subtle mt-1"> <div class="flex flex-col gap-1 pt-3"> <a href="/" class="px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 text-text-secondary hover:text-white hover:bg-bg-raised"> Home </a><a href="/about" class="px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 text-text-secondary hover:text-white hover:bg-bg-raised"> About </a><a href="/projects" class="px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 text-text-secondary hover:text-white hover:bg-bg-raised"> Projects </a><a href="/articles" class="px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 text-text-secondary hover:text-white hover:bg-bg-raised"> Articles </a><a href="/findings" class="px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 text-text-secondary hover:text-white hover:bg-bg-raised"> Findings </a> <a href="/members/dashboard" class="mt-2 px-4 py-3 bg-accent-blue/20 border border-accent-blue/40 text-accent-blue text-sm font-semibold rounded-lg hover:bg-accent-blue hover:text-white transition-all duration-200">
Member Zone
</a> </div> </div> </nav> </header> <!-- Spacer for fixed nav --> <div class="h-16"></div> <script type="module">const e=document.getElementById("nav-header"),d=document.getElementById("mobile-menu-btn"),n=document.getElementById("mobile-menu"),r=document.getElementById("menu-icon"),o=document.getElementById("close-icon");window.addEventListener("scroll",()=>{window.scrollY>10?e?.classList.add("bg-bg-primary/90","backdrop-blur-md","border-b","border-border-subtle"):e?.classList.remove("bg-bg-primary/90","backdrop-blur-md","border-b","border-border-subtle")});d?.addEventListener("click",()=>{const t=d.getAttribute("aria-expanded")==="true";d.setAttribute("aria-expanded",String(!t)),n?.classList.toggle("hidden"),r?.classList.toggle("hidden"),o?.classList.toggle("hidden"),t?window.scrollY<=10&&e?.classList.remove("bg-bg-primary/95","backdrop-blur-md"):e?.classList.add("bg-bg-primary/95","backdrop-blur-md")});</script> <main>   <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 pt-12 pb-8"> <div class="animate-on-scroll"> <!-- Breadcrumb --> <nav class="flex items-center gap-2 text-sm text-text-muted mb-8"> <a href="/" class="hover:text-accent-blue transition-colors">Home</a> <span>›</span> <a href="/articles" class="hover:text-accent-blue transition-colors">Articles</a> <span>›</span> <span class="text-text-secondary truncate">LLMs, HTTPS Requests and Response Tampering</span> </nav> <!-- Category + date --> <div class="flex flex-wrap items-center gap-3 mb-5"> <span class="badge badge-blue">AI Security</span> <span class="text-text-muted text-sm">29 September 2025</span> <span class="text-text-muted text-sm flex items-center gap-1"> <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path> </svg> 12 min read
</span> </div> <!-- Title --> <h1 class="text-3xl sm:text-4xl md:text-5xl font-extrabold text-white leading-tight mb-6"> LLMs, HTTPS Requests and Response Tampering </h1> <!-- Description --> <p class="text-text-secondary text-xl leading-relaxed mb-8">How corporate network proxies and DPI devices tamper with HTTPS requests and responses — and why this breaks LLM CLI tools, AI coding assistants, and API clients in enterprise environments.</p> <!-- Tags --> <div class="flex flex-wrap gap-2 mb-8"> <span class="badge-gray text-xs">LLM</span><span class="badge-gray text-xs">HTTPS</span><span class="badge-gray text-xs">Proxy</span><span class="badge-gray text-xs">TLS</span><span class="badge-gray text-xs">SSL Inspection</span><span class="badge-gray text-xs">Enterprise Security</span><span class="badge-gray text-xs">AI Tools</span> </div> <!-- Divider --> <div class="border-b border-border-subtle"></div> </div> </div>  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-10"> <article class="prose-dark max-w-none
      [&_h1]:text-3xl [&_h1]:font-bold [&_h1]:text-text-primary [&_h1]:mb-6 [&_h1]:mt-10
      [&_h2]:text-2xl [&_h2]:font-bold [&_h2]:text-text-primary [&_h2]:mb-4 [&_h2]:mt-10 [&_h2]:pb-2 [&_h2]:border-b [&_h2]:border-border-subtle
      [&_h3]:text-xl [&_h3]:font-semibold [&_h3]:text-text-primary [&_h3]:mb-3 [&_h3]:mt-8
      [&_h4]:text-lg [&_h4]:font-semibold [&_h4]:text-text-primary [&_h4]:mb-2 [&_h4]:mt-6
      [&_p]:text-text-secondary [&_p]:leading-relaxed [&_p]:mb-4
      [&_ul]:text-text-secondary [&_ul]:space-y-2 [&_ul]:mb-4 [&_ul]:list-disc [&_ul]:pl-6
      [&_ol]:text-text-secondary [&_ol]:space-y-2 [&_ol]:mb-4 [&_ol]:list-decimal [&_ol]:pl-6
      [&_li]:leading-relaxed
      [&_a]:text-accent-blue [&_a]:hover:text-accent-cyan [&_a]:underline [&_a]:underline-offset-2 [&_a]:transition-colors
      [&_strong]:text-text-primary [&_strong]:font-semibold
      [&_em]:text-text-secondary [&_em]:italic
      [&_code]:bg-bg-raised [&_code]:text-accent-cyan [&_code]:px-1.5 [&_code]:py-0.5 [&_code]:rounded [&_code]:text-sm [&_code]:font-mono
      [&_pre]:bg-bg-raised [&_pre]:border [&_pre]:border-border-subtle [&_pre]:rounded-xl [&_pre]:p-6 [&_pre]:overflow-x-auto [&_pre]:mb-6
      [&_pre_code]:bg-transparent [&_pre_code]:text-text-secondary [&_pre_code]:p-0
      [&_blockquote]:border-l-4 [&_blockquote]:border-accent-blue [&_blockquote]:pl-4 [&_blockquote]:text-text-muted [&_blockquote]:italic [&_blockquote]:my-6
      [&_hr]:border-border-subtle [&_hr]:my-8
      [&_table]:w-full [&_table]:border-collapse [&_table]:mb-6
      [&_th]:text-left [&_th]:p-3 [&_th]:bg-bg-raised [&_th]:text-text-primary [&_th]:font-semibold [&_th]:border [&_th]:border-border-subtle
      [&_td]:p-3 [&_td]:text-text-secondary [&_td]:border [&_td]:border-border-subtle
      [&_img]:rounded-xl [&_img]:border [&_img]:border-border-subtle [&_img]:my-6">  <h2 id="the-problem">The Problem</h2>
<p>You’ve just installed Claude Code, the GitHub Copilot extension, or another AI coding assistant. You run it on your corporate laptop and immediately get SSL certificate errors, connection timeouts, or cryptic authentication failures.</p>
<p>This isn’t a bug in the tool. It’s your corporate network actively <strong>tampering with HTTPS traffic</strong>.</p>
<hr>
<h2 id="how-corporate-networks-break-llm-tools">How Corporate Networks Break LLM Tools</h2>
<p>Modern enterprise networks use SSL/TLS inspection proxies to decrypt and re-encrypt HTTPS traffic (see <a href="/articles/deep-dive-deep-packet-inspection">Deep Dive into Deep Packet Inspection</a>). This works transparently for web browsers because browsers trust the corporate CA certificate that gets distributed via Group Policy.</p>
<p>LLM CLI tools and API clients <strong>don’t use the system browser trust store by default</strong>. They use:</p>
<ul>
<li>Bundled CA certificates (Python’s <code>certifi</code>, Node.js’s built-in CA list)</li>
<li>OpenSSL system store (may or may not include corporate CAs)</li>
<li>Their own certificate validation logic</li>
</ul>
<p>When a corporate proxy intercepts the request to <code>api.anthropic.com</code> or <code>api.openai.com</code>, it presents a certificate signed by the <strong>corporate CA</strong>. The LLM tool doesn’t trust that CA, and rejects the connection.</p>
<hr>
<h2 id="observable-symptoms">Observable Symptoms</h2>
<h3 id="ssl-certificate-errors">SSL Certificate Errors</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> claude</span></span>
<span class="line"><span style="color:#B392F0">Error:</span><span style="color:#9ECBFF"> unable</span><span style="color:#9ECBFF"> to</span><span style="color:#9ECBFF"> verify</span><span style="color:#9ECBFF"> the</span><span style="color:#9ECBFF"> first</span><span style="color:#9ECBFF"> certificate</span></span>
<span class="line"><span style="color:#B392F0">    at</span><span style="color:#9ECBFF"> TLSSocket.onConnectEnd</span><span style="color:#E1E4E8"> (_tls_wrap.js:1495)</span></span>
<span class="line"><span style="color:#B392F0">SSL_ERROR_RX_RECORD_TOO_LONG</span></span>
<span class="line"><span style="color:#B392F0">certificate</span><span style="color:#9ECBFF"> verify</span><span style="color:#9ECBFF"> failed:</span><span style="color:#9ECBFF"> unable</span><span style="color:#9ECBFF"> to</span><span style="color:#9ECBFF"> get</span><span style="color:#9ECBFF"> local</span><span style="color:#9ECBFF"> issuer</span><span style="color:#9ECBFF"> certificate</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Python-based tools:</span></span>
<span class="line"><span style="color:#B392F0">requests.exceptions.SSLError:</span><span style="color:#9ECBFF"> HTTPSConnectionPool</span><span style="color:#E1E4E8">(host</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'api.anthropic.com',</span><span style="color:#E1E4E8"> port</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">443</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">:</span></span>
<span class="line"><span style="color:#B392F0">  Max</span><span style="color:#9ECBFF"> retries</span><span style="color:#9ECBFF"> exceeded...</span><span style="color:#9ECBFF"> CERTIFICATE_VERIFY_FAILED</span></span></code></pre>
<h3 id="silent-failures--timeouts">Silent Failures / Timeouts</h3>
<p>Some proxies perform <strong>response tampering</strong> — injecting error pages, modifying JSON responses, or stripping headers. This can cause:</p>
<ul>
<li>JSON parse errors (proxy injects HTML error page)</li>
<li>Authentication failures (proxy strips <code>Authorization</code> header)</li>
<li>Rate limit errors (proxy returns its own 429)</li>
<li>Partial response streaming (proxy buffers or truncates SSE streams)</li>
</ul>
<h3 id="streaming-response-issues">Streaming Response Issues</h3>
<p>LLM APIs commonly use <strong>Server-Sent Events (SSE)</strong> for streaming. Proxies often:</p>
<ul>
<li>Buffer the entire response before forwarding (destroying the streaming UX)</li>
<li>Strip <code>Transfer-Encoding: chunked</code> headers</li>
<li>Inject content into the stream</li>
</ul>
<hr>
<h2 id="diagnosing-the-issue">Diagnosing the Issue</h2>
<h3 id="step-1-check-if-youre-behind-a-proxy">Step 1: Check If You’re Behind a Proxy</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6A737D"># Check environment proxy settings</span></span>
<span class="line"><span style="color:#79B8FF">echo</span><span style="color:#E1E4E8"> $HTTP_PROXY $HTTPS_PROXY $http_proxy $https_proxy</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Check system proxy (macOS)</span></span>
<span class="line"><span style="color:#B392F0">networksetup</span><span style="color:#79B8FF"> -getwebproxy</span><span style="color:#9ECBFF"> Wi-Fi</span></span>
<span class="line"><span style="color:#B392F0">networksetup</span><span style="color:#79B8FF"> -getsecurewebproxy</span><span style="color:#9ECBFF"> Wi-Fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Check system proxy (Windows PowerShell)</span></span>
<span class="line"><span style="color:#B392F0">Get-ItemProperty</span><span style="color:#79B8FF"> -Path</span><span style="color:#9ECBFF"> 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings'</span></span></code></pre>
<h3 id="step-2-inspect-the-certificate-being-presented">Step 2: Inspect the Certificate Being Presented</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6A737D"># See what certificate the proxy presents for an LLM API endpoint</span></span>
<span class="line"><span style="color:#79B8FF">echo</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> openssl</span><span style="color:#9ECBFF"> s_client</span><span style="color:#79B8FF"> -connect</span><span style="color:#9ECBFF"> api.anthropic.com:443</span><span style="color:#F97583"> 2></span><span style="color:#9ECBFF">/dev/null</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> openssl</span><span style="color:#9ECBFF"> x509</span><span style="color:#79B8FF"> -noout</span><span style="color:#79B8FF"> -issuer</span><span style="color:#79B8FF"> -subject</span><span style="color:#79B8FF"> -dates</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># If you see your corporate org in the issuer field, DPI is active:</span></span>
<span class="line"><span style="color:#6A737D"># issuer=O=Contoso Corp, CN=Contoso Secure Proxy CA</span></span></code></pre>
<h3 id="step-3-test-with-certificate-verification-disabled-diagnostic-only">Step 3: Test With Certificate Verification Disabled (Diagnostic Only)</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6A737D"># NEVER use this in production — for diagnosis only</span></span>
<span class="line"><span style="color:#B392F0">curl</span><span style="color:#79B8FF"> -k</span><span style="color:#9ECBFF"> https://api.anthropic.com/v1/messages</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">  -H</span><span style="color:#9ECBFF"> "x-api-key: </span><span style="color:#E1E4E8">$ANTHROPIC_API_KEY</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">  -H</span><span style="color:#9ECBFF"> "anthropic-version: 2023-06-01"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">  -H</span><span style="color:#9ECBFF"> "content-type: application/json"</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#79B8FF">  -d</span><span style="color:#9ECBFF"> '{"model":"claude-3-haiku-20240307","max_tokens":10,"messages":[{"role":"user","content":"ping"}]}'</span></span></code></pre>
<p>If this works with <code>-k</code> but fails without it, you have a certificate trust problem.</p>
<hr>
<h2 id="solutions">Solutions</h2>
<h3 id="solution-1-export-and-trust-the-corporate-ca">Solution 1: Export and Trust the Corporate CA</h3>
<p>The proper fix is to add the corporate CA to your tool’s trust store.</p>
<p><strong>Export the corporate CA:</strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6A737D"># From a browser (Chrome): Settings > Security > Manage Certificates > Export</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Via OpenSSL from a known HTTPS site</span></span>
<span class="line"><span style="color:#79B8FF">echo</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> openssl</span><span style="color:#9ECBFF"> s_client</span><span style="color:#79B8FF"> -connect</span><span style="color:#9ECBFF"> internal.example.com:443</span><span style="color:#79B8FF"> -showcerts</span><span style="color:#F97583"> 2></span><span style="color:#9ECBFF">/dev/null</span><span style="color:#F97583"> |</span><span style="color:#79B8FF"> \</span></span>
<span class="line"><span style="color:#B392F0">  openssl</span><span style="color:#9ECBFF"> x509</span><span style="color:#79B8FF"> -outform</span><span style="color:#9ECBFF"> PEM</span><span style="color:#F97583"> ></span><span style="color:#9ECBFF"> /tmp/corporate-ca.pem</span></span></code></pre>
<p><strong>Configure tools to use it:</strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6A737D"># Python / pip</span></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> REQUESTS_CA_BUNDLE</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">/path/to/corporate-ca.pem</span></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> SSL_CERT_FILE</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">/path/to/corporate-ca.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Node.js</span></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> NODE_EXTRA_CA_CERTS</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">/path/to/corporate-ca.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># curl</span></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> CURL_CA_BUNDLE</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">/path/to/corporate-ca.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Git</span></span>
<span class="line"><span style="color:#B392F0">git</span><span style="color:#9ECBFF"> config</span><span style="color:#79B8FF"> --global</span><span style="color:#9ECBFF"> http.sslCAInfo</span><span style="color:#9ECBFF"> /path/to/corporate-ca.pem</span></span></code></pre>
<p><strong>Add to system trust store (Linux):</strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6A737D"># Ubuntu/Debian</span></span>
<span class="line"><span style="color:#B392F0">sudo</span><span style="color:#9ECBFF"> cp</span><span style="color:#9ECBFF"> corporate-ca.pem</span><span style="color:#9ECBFF"> /usr/local/share/ca-certificates/corporate-ca.crt</span></span>
<span class="line"><span style="color:#B392F0">sudo</span><span style="color:#9ECBFF"> update-ca-certificates</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># RHEL/CentOS/Fedora</span></span>
<span class="line"><span style="color:#B392F0">sudo</span><span style="color:#9ECBFF"> cp</span><span style="color:#9ECBFF"> corporate-ca.pem</span><span style="color:#9ECBFF"> /etc/pki/ca-trust/source/anchors/</span></span>
<span class="line"><span style="color:#B392F0">sudo</span><span style="color:#9ECBFF"> update-ca-trust</span></span></code></pre>
<h3 id="solution-2-configure-proxy-settings-explicitly">Solution 2: Configure Proxy Settings Explicitly</h3>
<p>Many tools respect standard proxy environment variables:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> HTTP_PROXY</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">http://proxy.internal.example.com:8080</span></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> HTTPS_PROXY</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">http://proxy.internal.example.com:8080</span></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> NO_PROXY</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">localhost,127.0.0.1,.internal.example.com</span></span></code></pre>
<h3 id="solution-3-use-a-non-inspected-path">Solution 3: Use a Non-Inspected Path</h3>
<p>Some environments offer exceptions for specific destinations. Work with your security team to add LLM API endpoints to the SSL inspection bypass list.</p>
<hr>
<h2 id="response-tampering-beyond-certificate-substitution">Response Tampering Beyond Certificate Substitution</h2>
<p>SSL inspection isn’t the only form of tampering. Proxies may also:</p>
<h3 id="header-injectionremoval">Header Injection/Removal</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span># Proxy may remove:</span></span>
<span class="line"><span>Authorization: Bearer sk-...</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Proxy may inject:</span></span>
<span class="line"><span>X-Forwarded-For: 10.0.0.1</span></span>
<span class="line"><span>Via: 1.1 corporate-proxy</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Some proxies inject authentication tokens they control,</span></span>
<span class="line"><span># bypassing your intended authentication</span></span></code></pre>
<h3 id="content-modification">Content Modification</h3>
<p>Some DLP (Data Loss Prevention) solutions actively modify response content or block certain patterns in requests (e.g., API keys, personal data). This can break:</p>
<ul>
<li>Base64-encoded content in JSON payloads</li>
<li>Code containing patterns that match DLP rules</li>
<li>Large payloads that trigger size limits</li>
</ul>
<h3 id="connection-hijacking">Connection Hijacking</h3>
<p>In extreme cases, proxies may:</p>
<ul>
<li>Return cached responses instead of live API responses</li>
<li>Redirect to error pages that look like API responses</li>
<li>Modify JSON to strip or alter content</li>
</ul>
<hr>
<h2 id="implications-for-ai-security">Implications for AI Security</h2>
<p>From a security research perspective, corporate SSL inspection creates interesting attack surfaces:</p>
<ol>
<li><strong>The proxy as a credential store</strong> — SSL inspection proxies often log decrypted traffic, including API keys and tokens</li>
<li><strong>Proxy as a MITM target</strong> — compromise of the inspection device yields decryption capability for all inspected traffic</li>
<li><strong>Trust chain pollution</strong> — adding corporate CAs to developer laptops can enable future interception beyond the intended scope</li>
</ol>
<p>For organisations deploying LLM tools to corporate users: document the SSL inspection bypass configuration and provide it alongside the tool deployment. This reduces the likelihood of developers disabling certificate verification enterprise-wide as a workaround.</p>
<hr>
<h2 id="quick-reference">Quick Reference</h2>



































<table><thead><tr><th>Problem</th><th>Diagnostic</th><th>Fix</th></tr></thead><tbody><tr><td>SSL cert error</td><td><code>openssl s_client</code> check issuer</td><td>Export corporate CA, set <code>REQUESTS_CA_BUNDLE</code></td></tr><tr><td>Streaming broken</td><td>Check proxy buffering</td><td>Request SSE bypass from security team</td></tr><tr><td>Auth failures</td><td>Check if <code>Authorization</code> header reaches destination</td><td>Verify with <code>-v</code> in curl</td></tr><tr><td>JSON parse errors</td><td>Check raw response</td><td>Look for proxy HTML injection</td></tr><tr><td>Timeout</td><td>Check <code>HTTPS_PROXY</code> env var</td><td>Set explicit proxy or request bypass</td></tr></tbody></table>  </article> </div>  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 pb-16"> <div class="border-t border-border-subtle pt-8"> <a href="/articles" class="btn-outline">← Back to Articles</a> </div> </div>  </main> <footer class="bg-bg-surface border-t border-border-subtle mt-24"> <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"> <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-10"> <!-- Brand --> <div> <a href="/" class="flex items-center gap-3 mb-4"> <img src="/photon-sec-logo-banner.svg" alt="PhotonSec" class="h-12 w-auto"> </a> <p class="text-text-muted text-sm leading-relaxed max-w-xs">
Cybersecurity consulting, research, and tooling. Offensive security, cloud hardening, AI/LLM security.
</p> </div> <!-- Links --> <div> <h3 class="text-text-primary font-semibold text-sm uppercase tracking-wider mb-4">Navigation</h3> <ul class="space-y-2"> <li> <a href="/about" class="text-text-muted text-sm hover:text-accent-blue transition-colors"> About </a> </li><li> <a href="/projects" class="text-text-muted text-sm hover:text-accent-blue transition-colors"> Projects </a> </li><li> <a href="/articles" class="text-text-muted text-sm hover:text-accent-blue transition-colors"> Articles </a> </li><li> <a href="/findings" class="text-text-muted text-sm hover:text-accent-blue transition-colors"> Findings </a> </li><li> <a href="/members/dashboard" class="text-text-muted text-sm hover:text-accent-blue transition-colors"> Member Zone </a> </li> </ul> </div> <!-- Contact & Social --> <div> <h3 class="text-text-primary font-semibold text-sm uppercase tracking-wider mb-4">Connect</h3> <div class="flex gap-3 mb-4"> <a href="https://github.com/Enelass" target="_blank" rel="noopener noreferrer" class="p-2 bg-bg-raised border border-border-subtle rounded-lg text-text-muted hover:text-accent-blue hover:border-accent-blue/40 transition-all duration-200" aria-label="GitHub"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"/></svg></a><a href="https://www.linkedin.com/in/bidabe" target="_blank" rel="noopener noreferrer" class="p-2 bg-bg-raised border border-border-subtle rounded-lg text-text-muted hover:text-accent-blue hover:border-accent-blue/40 transition-all duration-200" aria-label="LinkedIn"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a> </div> <p class="text-text-muted text-sm"> <a href="mailto:contact@photonsec.com.au" class="hover:text-accent-blue transition-colors">
contact@photonsec.com.au
</a> </p> <p class="text-text-muted text-sm mt-1">Australia</p> </div> </div> <!-- Bottom bar --> <div class="pt-8 border-t border-border-subtle flex flex-col sm:flex-row items-center justify-between gap-4"> <p class="text-text-muted text-xs">
&copy; 2026 PhotonSec. All rights reserved.
</p> <div class="flex flex-col sm:flex-row items-center gap-4"> <p class="text-text-muted text-xs">
Florian Bidabé — Cyber Security Leader & Bug Bounty Researcher
</p> <div class="flex gap-4 text-text-muted text-xs"> <a href="/privacy" class="hover:text-accent-blue transition-colors"> Privacy Policy </a><a href="/terms" class="hover:text-accent-blue transition-colors"> Terms of Service </a> </div> </div> </div> </div> </footer> <!-- Scroll animation observer --> <script type="module">const o=new IntersectionObserver(e=>{e.forEach(r=>{r.isIntersecting&&r.target.classList.add("visible")})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});document.querySelectorAll(".animate-on-scroll").forEach(e=>{o.observe(e)});</script> </body> </html>